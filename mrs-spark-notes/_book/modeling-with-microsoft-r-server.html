<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Scalable Machine Learning and Data Science with Microsoft R Server and Spark</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="These are (tentatively) rough notes showcasing some tips on conducting large scale data analysis with R, Spark, and Microsoft R Server. The focus is primarily on machine learning with Azure HDInsight platform, but review other in-memory, large-scale data analysis platforms, such as R Services with SQL Server 2016, and discuss how to utilize BI tools such as PowerBI and Shiny for dynamic reporting, and report generation.">
  <meta name="generator" content="bookdown 0.0.66 and GitBook 2.6.7">

  <meta property="og:title" content="Scalable Machine Learning and Data Science with Microsoft R Server and Spark" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are (tentatively) rough notes showcasing some tips on conducting large scale data analysis with R, Spark, and Microsoft R Server. The focus is primarily on machine learning with Azure HDInsight platform, but review other in-memory, large-scale data analysis platforms, such as R Services with SQL Server 2016, and discuss how to utilize BI tools such as PowerBI and Shiny for dynamic reporting, and report generation." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Scalable Machine Learning and Data Science with Microsoft R Server and Spark" />
  
  <meta name="twitter:description" content="These are (tentatively) rough notes showcasing some tips on conducting large scale data analysis with R, Spark, and Microsoft R Server. The focus is primarily on machine learning with Azure HDInsight platform, but review other in-memory, large-scale data analysis platforms, such as R Services with SQL Server 2016, and discuss how to utilize BI tools such as PowerBI and Shiny for dynamic reporting, and report generation." />
  

<meta name="author" content="Ali Zaidi, Machine Learning and Data Science, Microsoft">

<meta name="date" content="2016-05-03">


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="data-manipulation-with-sparkr.html">
<link rel="next" href="references.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.6.1/htmlwidgets.js"></script>
<script src="libs/d3-3.5.5/d3.min.js"></script>
<script src="libs/d3-grid-0.1.0/d3-grid.js"></script>
<script src="libs/dimple-2.1.6/dimple.min.js"></script>
<script src="libs/dimple-binding-0.1/dimple.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Scalable Machine Learning with MRS and Spark</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Abstract</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#scalable-machine-learning-with-microsoft-r-server-and-spark"><i class="fa fa-check"></i>Scalable Machine Learning with Microsoft R Server and Spark</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#useful-resources"><i class="fa fa-check"></i>Useful Resources</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#spark"><i class="fa fa-check"></i>Spark</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#microsoft-r-server"><i class="fa fa-check"></i>Microsoft R Server</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#azure-hdinsight"><i class="fa fa-check"></i>Azure HDInsight</a></li>
</ul></li>
</ul></li>
<li class="part"><b><a href="#">Overview</a></b></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#why-r"><i class="fa fa-check"></i><b>1.1</b> Why R?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#microsoft-r-server-ftw"><i class="fa fa-check"></i><b>1.2</b> Microsoft R Server FTW</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#apache-spark"><i class="fa fa-check"></i><b>1.3</b> Apache Spark</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#sparkr"><i class="fa fa-check"></i><b>1.4</b> SparkR</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#azure-hdinsight-1"><i class="fa fa-check"></i><b>1.5</b> Azure HDInsight</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#prerequisites---what-youll-need"><i class="fa fa-check"></i><b>1.6</b> Prerequisites - What Youâ€™ll Need</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#versioning"><i class="fa fa-check"></i><b>1.7</b> Versioning</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="apache-spark-1.html"><a href="apache-spark-1.html"><i class="fa fa-check"></i><b>2</b> Apache Spark</a><ul>
<li class="chapter" data-level="2.1" data-path="apache-spark-1.html"><a href="apache-spark-1.html#lazyevalfp"><i class="fa fa-check"></i><b>2.1</b> Functional Programming and Lazy Evaluation</a></li>
<li class="chapter" data-level="2.2" data-path="apache-spark-1.html"><a href="apache-spark-1.html#distributed-programming-abstractions"><i class="fa fa-check"></i><b>2.2</b> Distributed Programming Abstractions</a></li>
<li class="chapter" data-level="2.3" data-path="apache-spark-1.html"><a href="apache-spark-1.html#rdds"><i class="fa fa-check"></i><b>2.3</b> RDDs</a><ul>
<li class="chapter" data-level="2.3.1" data-path="apache-spark-1.html"><a href="apache-spark-1.html#common-transformations-and-actions"><i class="fa fa-check"></i><b>2.3.1</b> Common Transformations and Actions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="apache-spark-1.html"><a href="apache-spark-1.html#dataframes"><i class="fa fa-check"></i><b>2.4</b> <a href="https://databricks.com/blog/2015/02/17/introducing-dataframes-in-spark-for-large-scale-data-science.html">DataFrames</a></a></li>
<li class="chapter" data-level="2.5" data-path="apache-spark-1.html"><a href="apache-spark-1.html#datasets"><i class="fa fa-check"></i><b>2.5</b> Datasets</a></li>
<li class="chapter" data-level="2.6" data-path="apache-spark-1.html"><a href="apache-spark-1.html#mllib"><i class="fa fa-check"></i><b>2.6</b> MLlib</a></li>
<li class="chapter" data-level="2.7" data-path="apache-spark-1.html"><a href="apache-spark-1.html#spark-apis"><i class="fa fa-check"></i><b>2.7</b> Spark APIs</a><ul>
<li class="chapter" data-level="2.7.1" data-path="apache-spark-1.html"><a href="apache-spark-1.html#scala"><i class="fa fa-check"></i><b>2.7.1</b> Scala</a></li>
<li class="chapter" data-level="2.7.2" data-path="apache-spark-1.html"><a href="apache-spark-1.html#pyspark"><i class="fa fa-check"></i><b>2.7.2</b> <a href="https://spark.apache.org/docs/latest/api/python/index.html">PySpark</a></a></li>
<li class="chapter" data-level="2.7.3" data-path="apache-spark-1.html"><a href="apache-spark-1.html#sparkr-1"><i class="fa fa-check"></i><b>2.7.3</b> SparkR</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="rserver.html"><a href="rserver.html"><i class="fa fa-check"></i><b>3</b> R &amp; Microsoft R Server - todo</a><ul>
<li class="chapter" data-level="3.1" data-path="rserver.html"><a href="rserver.html#functional-programming-and-lazy-evaluation-in-r"><i class="fa fa-check"></i><b>3.1</b> Functional Programming and Lazy Evaluation in R</a></li>
<li class="chapter" data-level="3.2" data-path="rserver.html"><a href="rserver.html#pema"><i class="fa fa-check"></i><b>3.2</b> PEMA Algorithms and the RevoScaleR Package</a></li>
<li class="chapter" data-level="3.3" data-path="rserver.html"><a href="rserver.html#xdf"><i class="fa fa-check"></i><b>3.3</b> eXternal Data Frames (XDFs)</a></li>
<li class="chapter" data-level="3.4" data-path="rserver.html"><a href="rserver.html#computecontext"><i class="fa fa-check"></i><b>3.4</b> Compute Contexts</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="azure-hdinsight-managed-hadoop-in-the-cloud-todo.html"><a href="azure-hdinsight-managed-hadoop-in-the-cloud-todo.html"><i class="fa fa-check"></i><b>4</b> Azure HDInsight â€“ Managed Hadoop in the Cloud - todo</a><ul>
<li class="chapter" data-level="4.1" data-path="azure-hdinsight-managed-hadoop-in-the-cloud-todo.html"><a href="azure-hdinsight-managed-hadoop-in-the-cloud-todo.html#hdinsight-premium-spark-clusters-with-r-server"><i class="fa fa-check"></i><b>4.1</b> HDInsight Premium Spark Clusters with R Server</a></li>
<li class="chapter" data-level="4.2" data-path="azure-hdinsight-managed-hadoop-in-the-cloud-todo.html"><a href="azure-hdinsight-managed-hadoop-in-the-cloud-todo.html#dashboards-for-management"><i class="fa fa-check"></i><b>4.2</b> Dashboards for Management</a></li>
<li class="chapter" data-level="4.3" data-path="azure-hdinsight-managed-hadoop-in-the-cloud-todo.html"><a href="azure-hdinsight-managed-hadoop-in-the-cloud-todo.html#jupyter-and-rstudio-server"><i class="fa fa-check"></i><b>4.3</b> Jupyter and RStudio Server</a></li>
</ul></li>
<li class="part"><b><a href="#">Provisioning and Ingesting Data</a></b></li>
<li class="chapter" data-level="5" data-path="provisioning-instructions.html"><a href="provisioning-instructions.html"><i class="fa fa-check"></i><b>5</b> Provisioning Instructions</a><ul>
<li class="chapter" data-level="5.1" data-path="provisioning-instructions.html"><a href="provisioning-instructions.html#provision-cluster-from-azure-portal"><i class="fa fa-check"></i><b>5.1</b> Provision Cluster from Azure Portal</a></li>
<li class="chapter" data-level="5.2" data-path="provisioning-instructions.html"><a href="provisioning-instructions.html#installing-packages"><i class="fa fa-check"></i><b>5.2</b> Installing Packages</a><ul>
<li class="chapter" data-level="5.2.1" data-path="provisioning-instructions.html"><a href="provisioning-instructions.html#todo---install-packages-demo"><i class="fa fa-check"></i><b>5.2.1</b> todo - install packages demo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ingestion.html"><a href="ingestion.html"><i class="fa fa-check"></i><b>6</b> Ingesting Data into Azure Blob Storage - todo</a><ul>
<li class="chapter" data-level="6.1" data-path="ingestion.html"><a href="ingestion.html#azcopy"><i class="fa fa-check"></i><b>6.1</b> AzCopy</a></li>
<li class="chapter" data-level="6.2" data-path="ingestion.html"><a href="ingestion.html#azure-storage-explorer"><i class="fa fa-check"></i><b>6.2</b> Azure Storage Explorer</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="setting-your-r-profile.html"><a href="setting-your-r-profile.html"><i class="fa fa-check"></i><b>7</b> Setting Your R Profile</a></li>
<li class="part"><b><a href="#">Data Manipulation and Data Aggregation</a></b></li>
<li class="chapter" data-level="8" data-path="starting-your-machine-learning-pipeline.html"><a href="starting-your-machine-learning-pipeline.html"><i class="fa fa-check"></i><b>8</b> Starting Your Machine Learning Pipeline</a><ul>
<li class="chapter" data-level="8.1" data-path="starting-your-machine-learning-pipeline.html"><a href="starting-your-machine-learning-pipeline.html#todo"><i class="fa fa-check"></i><b>8.1</b> todo</a></li>
<li class="chapter" data-level="8.2" data-path="starting-your-machine-learning-pipeline.html"><a href="starting-your-machine-learning-pipeline.html#finding-the-sparkr-library"><i class="fa fa-check"></i><b>8.2</b> Finding the SparkR Library</a></li>
<li class="chapter" data-level="8.3" data-path="starting-your-machine-learning-pipeline.html"><a href="starting-your-machine-learning-pipeline.html#creating-a-spark-context"><i class="fa fa-check"></i><b>8.3</b> Creating a Spark Context</a></li>
<li class="chapter" data-level="8.4" data-path="starting-your-machine-learning-pipeline.html"><a href="starting-your-machine-learning-pipeline.html#creating-dataframes"><i class="fa fa-check"></i><b>8.4</b> Creating DataFrames</a><ul>
<li class="chapter" data-level="8.4.1" data-path="starting-your-machine-learning-pipeline.html"><a href="starting-your-machine-learning-pipeline.html#from-local-r-data.frames"><i class="fa fa-check"></i><b>8.4.1</b> From Local R data.frames</a></li>
<li class="chapter" data-level="8.4.2" data-path="starting-your-machine-learning-pipeline.html"><a href="starting-your-machine-learning-pipeline.html#creating-dataframes-from-csv-files"><i class="fa fa-check"></i><b>8.4.2</b> Creating DataFrames from CSV Files</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-manipulation-with-sparkr.html"><a href="data-manipulation-with-sparkr.html"><i class="fa fa-check"></i><b>9</b> Data Manipulation with SparkR</a><ul>
<li class="chapter" data-level="9.1" data-path="data-manipulation-with-sparkr.html"><a href="data-manipulation-with-sparkr.html#data-aggregations"><i class="fa fa-check"></i><b>9.1</b> Data Aggregations</a><ul>
<li class="chapter" data-level="9.1.1" data-path="data-manipulation-with-sparkr.html"><a href="data-manipulation-with-sparkr.html#merging-data"><i class="fa fa-check"></i><b>9.1.1</b> Merging Data</a></li>
</ul></li>
</ul></li>
<li class="part"><b><a href="#">Modeling and Prediction with Microsoft R Server</a></b></li>
<li class="chapter" data-level="10" data-path="modeling-with-microsoft-r-server.html"><a href="modeling-with-microsoft-r-server.html"><i class="fa fa-check"></i><b>10</b> Modeling with Microsoft R Server</a><ul>
<li class="chapter" data-level="10.1" data-path="modeling-with-microsoft-r-server.html"><a href="modeling-with-microsoft-r-server.html#import-csv-to-xdf"><i class="fa fa-check"></i><b>10.1</b> Import CSV to XDF</a></li>
<li class="chapter" data-level="10.2" data-path="modeling-with-microsoft-r-server.html"><a href="modeling-with-microsoft-r-server.html#splitting-xdf-into-train-and-test-tests"><i class="fa fa-check"></i><b>10.2</b> Splitting XDF into Train and Test Tests</a></li>
<li class="chapter" data-level="10.3" data-path="modeling-with-microsoft-r-server.html"><a href="modeling-with-microsoft-r-server.html#training-binary-classification-models"><i class="fa fa-check"></i><b>10.3</b> Training Binary Classification Models</a><ul>
<li class="chapter" data-level="10.3.1" data-path="modeling-with-microsoft-r-server.html"><a href="modeling-with-microsoft-r-server.html#logistic-regression-models"><i class="fa fa-check"></i><b>10.3.1</b> Logistic Regression Models</a></li>
<li class="chapter" data-level="10.3.2" data-path="modeling-with-microsoft-r-server.html"><a href="modeling-with-microsoft-r-server.html#tree-and-ensemble-classifiers"><i class="fa fa-check"></i><b>10.3.2</b> Tree and Ensemble Classifiers</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="modeling-with-microsoft-r-server.html"><a href="modeling-with-microsoft-r-server.html#testing-models"><i class="fa fa-check"></i><b>10.4</b> Testing Models</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>11</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Scalable Machine Learning and Data Science with Microsoft R Server and Spark</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modeling-with-microsoft-r-server" class="section level1">
<h1><span class="header-section-number">Chapter 10</span> Modeling with Microsoft R Server</h1>
<div id="import-csv-to-xdf" class="section level2">
<h2><span class="header-section-number">10.1</span> Import CSV to XDF</h2>
<p>To take full advantage of the PEMA algorithms provided by MRS, we will import the merged data, currently saved as csv in blob storage, into an xdf.</p>
<p>We first have some housekeeping items to take care. We need to specify the spark compute context for the <code>RevoScaleR</code> package to properly utlize the Spark cluster. Saving a text file to HDFS creates blocks of the data and saves them in separate directories, and also saves an additional directory entitled â€œ_SUCCESS&quot; to indicate the import operation was successful. We need to remove this file before importing to xdf, as it has no value for the final data.</p>
<p>Further, in order to make sure the MRS modeling functions respect the data types of the columns in our merged dataset, we need to provide it with some column metadata. This can be provided with the <code>colInfo</code> argument inside of <code>rxImport</code>.</p>
<p>Lastly, we need to provide MRS with pointers to the HDFS store we will be saving our XDF to.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rxOptions</span>(<span class="dt">fileSystem =</span> <span class="kw">RxHdfsFileSystem</span>())

dataDir &lt;-<span class="st"> &quot;/user/RevoShare/alizaidi/delayDataLarge&quot;</span>

if(<span class="kw">rxOptions</span>()$hdfsHost ==<span class="st"> &quot;default&quot;</span>) {
 fullDataDir &lt;-<span class="st"> </span>dataDir
} else {
 fullDataDir &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">rxOptions</span>()$hdfsHost, dataDir)
}  

computeContext &lt;-<span class="st"> </span><span class="kw">RxSpark</span>(<span class="dt">consoleOutput =</span> <span class="ot">TRUE</span>)

<span class="co"># there&#39;s a folder called SUCCESS_ that we need to delete manually</span>
file_to_delete &lt;-<span class="st"> </span><span class="kw">file.path</span>(data_dir, <span class="st">&quot;delayDataLarge&quot;</span>, <span class="st">&quot;JoinAirWeatherDelay&quot;</span>, <span class="st">&quot;_SUCCESS&quot;</span>)
delete_command &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;fs -rm&quot;</span>, file_to_delete)
<span class="kw">rxHadoopCommand</span>(delete_command)


colInfo &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="dt">ArrDel15 =</span> <span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;numeric&quot;</span>),
  <span class="dt">Year =</span> <span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;factor&quot;</span>),
  <span class="dt">Month =</span> <span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;factor&quot;</span>),
  <span class="dt">DayofMonth =</span> <span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;factor&quot;</span>),
  <span class="dt">DayOfWeek =</span> <span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;factor&quot;</span>),
  <span class="dt">Carrier =</span> <span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;factor&quot;</span>),
  <span class="dt">OriginAirportID =</span> <span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;factor&quot;</span>),
  <span class="dt">DestAirportID =</span> <span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;factor&quot;</span>),
  <span class="dt">RelativeHumidityOrigin =</span> <span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;numeric&quot;</span>),
  <span class="dt">AltimeterOrigin =</span> <span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;numeric&quot;</span>),
  <span class="dt">DryBulbCelsiusOrigin =</span> <span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;numeric&quot;</span>),
  <span class="dt">WindSpeedOrigin =</span> <span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;numeric&quot;</span>),
  <span class="dt">VisibilityOrigin =</span> <span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;numeric&quot;</span>),
  <span class="dt">DewPointCelsiusOrigin =</span> <span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;numeric&quot;</span>),
  <span class="dt">RelativeHumidityDest =</span> <span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;numeric&quot;</span>),
  <span class="dt">AltimeterDest =</span> <span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;numeric&quot;</span>),
  <span class="dt">DryBulbCelsiusDest =</span> <span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;numeric&quot;</span>),
  <span class="dt">WindSpeedDest =</span> <span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;numeric&quot;</span>),
  <span class="dt">VisibilityDest =</span> <span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;numeric&quot;</span>),
  <span class="dt">DewPointCelsiusDest =</span> <span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;numeric&quot;</span>),
  <span class="dt">CRSDepTime =</span> <span class="kw">list</span>(<span class="dt">type =</span> <span class="st">&quot;numeric&quot;</span>),
  <span class="dt">CRSArrTime =</span> <span class="kw">list</span>(<span class="dt">type =</span> <span class="st">&quot;numeric&quot;</span>),
  <span class="dt">DepDelay =</span> <span class="kw">list</span>(<span class="dt">type =</span> <span class="st">&quot;numeric&quot;</span>),
  <span class="dt">ArrDelay =</span> <span class="kw">list</span>(<span class="dt">type =</span> <span class="st">&quot;numeric&quot;</span>)
)

myNameNode &lt;-<span class="st"> &quot;default&quot;</span>
myPort &lt;-<span class="st"> </span><span class="dv">0</span>
hdfsFS &lt;-<span class="st"> </span><span class="kw">RxHdfsFileSystem</span>(<span class="dt">hostName =</span> myNameNode, 
                           <span class="dt">port =</span> myPort)

joined_txt &lt;-<span class="st"> </span><span class="kw">RxTextData</span>(<span class="kw">file.path</span>(data_dir, <span class="st">&quot;delayDataLarge&quot;</span>, <span class="st">&quot;JoinAirWeatherDelay&quot;</span>),
                           <span class="dt">colInfo =</span> colInfo,
                           <span class="dt">fileSystem =</span> hdfsFS)

dest_xdf &lt;-<span class="st"> </span><span class="kw">RxXdfData</span>(<span class="kw">file.path</span>(data_dir, <span class="st">&quot;delayDataLarge&quot;</span>, <span class="st">&quot;joinedAirWeatherXdf&quot;</span>),
                      <span class="dt">fileSystem =</span> hdfsFS)



<span class="kw">rxImport</span>(<span class="dt">inData =</span> joined_txt, dest_xdf, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Now that we have imported our data to an XDF, we can get some information about the variables:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rxGetInfo</span>(<span class="kw">RxXdfData</span>(<span class="kw">file.path</span>(data_dir, <span class="st">&quot;delayDataLarge&quot;</span>, <span class="st">&quot;joinedAirWeatherXdf&quot;</span>),
                      <span class="dt">fileSystem =</span> hdfsFS), <span class="dt">getVarInfo =</span> T, <span class="dt">numRows =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>## File name: /user/RevoShare/alizaidi/delayDataLarge/joinedAirWeatherXdf 
## Number of composite data files: 80 
## Number of observations: 148619655 
## Number of variables: 22 
## Number of blocks: 320 
## Compression type: zlib 
## Variable information: 
## Var 1: ArrDel15, Type: numeric, Low/High: (0.0000, 1.0000)
## Var 2: Year
##        26 factor levels: 1990 1992 1994 1997 1999 ... 2005 2008 2010 2011 2012
## Var 3: Month
##        12 factor levels: 3 8 9 2 5 ... 11 6 12 7 10
## Var 4: DayofMonth
##        31 factor levels: 11 23 9 26 4 ... 12 8 27 25 22
## Var 5: DayOfWeek
##        7 factor levels: 7 5 3 2 4 1 6
## Var 6: Carrier
##        30 factor levels: US UA DL NW DH ... PA (1) KH HA PS VX
## Var 7: OriginAirportID
##        374 factor levels: 10821 13930 11057 13230 11433 ... 10559 13341 14314 11931 10558
## Var 8: DestAirportID
##        378 factor levels: 10135 10136 10140 10146 10155 ... 10559 11931 10894 14475 12899
## Var 9: CRSDepTime, Type: numeric, Low/High: (0.0000, 24.0000)
## Var 10: CRSArrTime, Type: numeric, Low/High: (0.0000, 2400.0000)
## Var 11: RelativeHumidityOrigin, Type: numeric, Low/High: (0.0000, 100.0000)
## Var 12: AltimeterOrigin, Type: numeric, Low/High: (28.1700, 31.1600)
## Var 13: DryBulbCelsiusOrigin, Type: numeric, Low/High: (-46.1000, 47.2000)
## Var 14: WindSpeedOrigin, Type: numeric, Low/High: (0.0000, 81.0000)
## Var 15: VisibilityOrigin, Type: numeric, Low/High: (0.0000, 88.0000)
## Var 16: DewPointCelsiusOrigin, Type: numeric, Low/High: (-41.7000, 29.0000)
## Var 17: RelativeHumidityDest, Type: numeric, Low/High: (0.0000, 100.0000)
## Var 18: AltimeterDest, Type: numeric, Low/High: (28.1700, 31.1600)
## Var 19: DryBulbCelsiusDest, Type: numeric, Low/High: (-46.1000, 53.9000)
## Var 20: WindSpeedDest, Type: numeric, Low/High: (0.0000, 63.0000)
## Var 21: VisibilityDest, Type: numeric, Low/High: (0.0000, 88.0000)
## Var 22: DewPointCelsiusDest, Type: numeric, Low/High: (-43.0000, 29.0000)
## Data (2 rows starting with row 1):
##   ArrDel15 Year Month DayofMonth DayOfWeek Carrier OriginAirportID DestAirportID CRSDepTime CRSArrTime RelativeHumidityOrigin AltimeterOrigin DryBulbCelsiusOrigin WindSpeedOrigin
## 1        0 1990     3         11         7      US           10821         10135         10       1056                     NA              NA                   NA              NA
## 2        1 1992     8         23         7      UA           13930         10135          6        928                     NA              NA                   NA              NA
##   VisibilityOrigin DewPointCelsiusOrigin RelativeHumidityDest AltimeterDest DryBulbCelsiusDest WindSpeedDest VisibilityDest DewPointCelsiusDest
## 1               NA                    NA                   NA            NA                 NA            NA             NA                  NA
## 2               NA                    NA                   NA            NA                 NA            NA             NA                  NA</code></pre>
</div>
<div id="splitting-xdf-into-train-and-test-tests" class="section level2">
<h2><span class="header-section-number">10.2</span> Splitting XDF into Train and Test Tests</h2>
<p>Prior to estimating our predictive models, we need to split our dataset into a training set, which weâ€™ll use for estimation, and a test set that weâ€™ll use for validating our results.</p>
<p>Since we have time series data (data ordered by time), we will split our data by time. Weâ€™ll use the data prior to 2012 for training, and the data in 2012 for testing.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trainDS &lt;-<span class="st"> </span><span class="kw">RxXdfData</span>( <span class="kw">file.path</span>(dataDir, <span class="st">&quot;finalDataTrain&quot;</span> ),
                      <span class="dt">fileSystem =</span> hdfsFS)

<span class="kw">rxDataStep</span>( <span class="dt">inData =</span> dest_xdf, <span class="dt">outFile =</span> trainDS,
            <span class="dt">rowSelection =</span> ( Year !=<span class="st"> </span><span class="dv">2012</span> ), <span class="dt">overwrite =</span> T )

testDS &lt;-<span class="st"> </span><span class="kw">RxXdfData</span>( <span class="kw">file.path</span>(dataDir, <span class="st">&quot;finalDataTest&quot;</span> ),
                     <span class="dt">fileSystem =</span> hdfsFS)

<span class="kw">rxDataStep</span>( <span class="dt">inData =</span> dest_xdf, <span class="dt">outFile =</span> testDS,
            <span class="dt">rowSelection =</span> ( Year ==<span class="st"> </span><span class="dv">2012</span> ), <span class="dt">overwrite =</span> T )</code></pre></div>
</div>
<div id="training-binary-classification-models" class="section level2">
<h2><span class="header-section-number">10.3</span> Training Binary Classification Models</h2>
<p>Now that we have our train and test sets, we can estimate our predictive model. Letâ€™s try to predict the probability that a flight will be delayed as a function of other variables.</p>
<div id="logistic-regression-models" class="section level3">
<h3><span class="header-section-number">10.3.1</span> Logistic Regression Models</h3>
<p>RevoScaleR provides a highly optimized logistic regression model based on the Iteratively Reweighted Least Squares (IRLS) algorithm, which can be called using the <code>rxLogit</code> function. The <code>rxLogit</code> function looks nearly identical to the standard logistic regression function provided by the <code>glm</code> function in the base <code>stats</code> package, taking a formula as itâ€™s first argument, and the data as itâ€™s second argument.</p>
<p>We create a handy function <code>make_formula</code> for creating formula objects based on the variables in the <code>all_vars</code> argument of the function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">make_formula &lt;-<span class="st"> </span>function(resp_var,
                         vars_exclude,
                         all_vars) {
  
  features &lt;-<span class="st"> </span>all_vars[!(all_vars %in%<span class="st"> </span><span class="kw">c</span>(resp_var, vars_exclude))]
  form &lt;-<span class="st"> </span><span class="kw">as.formula</span>(<span class="kw">paste</span>(resp_var, <span class="kw">paste0</span>(features, <span class="dt">collapse =</span> <span class="st">&quot; + &quot;</span>),
                           <span class="dt">sep  =</span> <span class="st">&quot; ~ &quot;</span>))
  
  <span class="kw">return</span>(form)
}

data_names &lt;-<span class="st"> </span><span class="kw">rxGetVarNames</span>(trainDS)

form &lt;-<span class="st"> </span><span class="kw">make_formula</span>(<span class="st">&quot;ArrDel15&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;DepDelay&quot;</span>, <span class="st">&quot;ArrDelay&quot;</span>), data_names)

<span class="kw">system.time</span>(logitModel &lt;-<span class="st"> </span><span class="kw">rxLogit</span>(form, <span class="dt">data =</span> trainDS))
 <span class="co">#   user  system elapsed </span>
 <span class="co"># 15.916  17.068 302.806 </span>

base::<span class="kw">summary</span>(logitModel)</code></pre></div>
</div>
<div id="tree-and-ensemble-classifiers" class="section level3">
<h3><span class="header-section-number">10.3.2</span> Tree and Ensemble Classifiers</h3>
<p>Training the logistic regression model on the full training set took about five minutes. Logistic regression models are frequently used for classification problems due to their interpability and extensibility. However, without adequeate feature engineering, logistic regression models tend to lack the expressiveness and predictive power of ensemble methods, such as boosted trees, or random forests.</p>
<p>Using the same methodology as above, we could estimate decision trees and decision forests (random forests) just as easily with the same formula:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(dTreeModel &lt;-<span class="st"> </span><span class="kw">rxDTree</span>(form, <span class="dt">data =</span> trainDS,
                                  <span class="dt">maxDepth =</span> <span class="dv">6</span>, <span class="dt">pruneCp =</span> <span class="st">&quot;auto&quot;</span>))
  <span class="co">#   user   system  elapsed </span>
  <span class="co"># 29.088   67.940 1265.633</span></code></pre></div>
</div>
</div>
<div id="testing-models" class="section level2">
<h2><span class="header-section-number">10.4</span> Testing Models</h2>
<p>Now that we have estimated our models, we can calculate valuation metrics for them by scoring on the test/held-out set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;testModels.RData&quot;</span>)

treePredict &lt;-<span class="st"> </span><span class="kw">RxXdfData</span>(<span class="kw">file.path</span>(dataDir, <span class="st">&quot;treePredict&quot;</span>),
                         <span class="dt">fileSystem =</span> hdfsFS)

<span class="kw">system.time</span>(<span class="kw">rxPredict</span>(dTreeModel, <span class="dt">data =</span> testDS, <span class="dt">outData =</span> treePredict, 
                      <span class="dt">extraVarsToWrite =</span> <span class="kw">c</span>(<span class="st">&quot;ArrDel15&quot;</span>), <span class="dt">overwrite =</span> <span class="ot">TRUE</span>))</code></pre></div>
<pre><code>## Rows Read: 20577, Total Rows Processed: 20577, Total Chunk Time: 2.296 seconds
## Rows Read: 20524, Total Rows Processed: 41101, Total Chunk Time: 2.911 seconds
## Rows Read: 20487, Total Rows Processed: 61588, Total Chunk Time: 0.129 seconds
## Rows Read: 14729, Total Rows Processed: 76317, Total Chunk Time: 0.071 seconds
## Rows Read: 20509, Total Rows Processed: 96826, Total Chunk Time: 0.366 seconds
## Rows Read: 20455, Total Rows Processed: 117281, Total Chunk Time: 0.040 seconds
## Rows Read: 20623, Total Rows Processed: 137904, Total Chunk Time: 0.040 seconds
## Rows Read: 14643, Total Rows Processed: 152547, Total Chunk Time: 0.040 seconds
## Rows Read: 20513, Total Rows Processed: 173060, Total Chunk Time: 0.447 seconds
## Rows Read: 20587, Total Rows Processed: 193647, Total Chunk Time: 0.061 seconds
## Rows Read: 20583, Total Rows Processed: 214230, Total Chunk Time: 0.055 seconds
## Rows Read: 14622, Total Rows Processed: 228852, Total Chunk Time: 0.039 seconds
## Rows Read: 20532, Total Rows Processed: 249384, Total Chunk Time: 0.513 seconds
## Rows Read: 20500, Total Rows Processed: 269884, Total Chunk Time: 0.039 seconds
## Rows Read: 20609, Total Rows Processed: 290493, Total Chunk Time: 0.040 seconds
## Rows Read: 14703, Total Rows Processed: 305196, Total Chunk Time: 0.040 seconds
## Rows Read: 20573, Total Rows Processed: 325769, Total Chunk Time: 0.433 seconds
## Rows Read: 20516, Total Rows Processed: 346285, Total Chunk Time: 0.048 seconds
## Rows Read: 20584, Total Rows Processed: 366869, Total Chunk Time: 0.045 seconds
## Rows Read: 14682, Total Rows Processed: 381551, Total Chunk Time: 0.041 seconds
## Rows Read: 20569, Total Rows Processed: 402120, Total Chunk Time: 0.353 seconds
## Rows Read: 20514, Total Rows Processed: 422634, Total Chunk Time: 0.052 seconds
## Rows Read: 20588, Total Rows Processed: 443222, Total Chunk Time: 0.044 seconds
## Rows Read: 14649, Total Rows Processed: 457871, Total Chunk Time: 0.043 seconds
## Rows Read: 20520, Total Rows Processed: 478391, Total Chunk Time: 0.410 seconds
## Rows Read: 20495, Total Rows Processed: 498886, Total Chunk Time: 0.043 seconds
## Rows Read: 20651, Total Rows Processed: 519537, Total Chunk Time: 0.039 seconds
## Rows Read: 14678, Total Rows Processed: 534215, Total Chunk Time: 0.040 seconds
## Rows Read: 20525, Total Rows Processed: 554740, Total Chunk Time: 0.355 seconds
## Rows Read: 20535, Total Rows Processed: 575275, Total Chunk Time: 0.061 seconds
## Rows Read: 20575, Total Rows Processed: 595850, Total Chunk Time: 0.059 seconds
## Rows Read: 14686, Total Rows Processed: 610536, Total Chunk Time: 0.055 seconds
## Rows Read: 20585, Total Rows Processed: 631121, Total Chunk Time: 0.306 seconds
## Rows Read: 20456, Total Rows Processed: 651577, Total Chunk Time: 0.045 seconds
## Rows Read: 20564, Total Rows Processed: 672141, Total Chunk Time: 0.049 seconds
## Rows Read: 14710, Total Rows Processed: 686851, Total Chunk Time: 0.045 seconds
## Rows Read: 20561, Total Rows Processed: 707412, Total Chunk Time: 0.351 seconds
## Rows Read: 20506, Total Rows Processed: 727918, Total Chunk Time: 0.071 seconds
## Rows Read: 20560, Total Rows Processed: 748478, Total Chunk Time: 0.050 seconds
## Rows Read: 14680, Total Rows Processed: 763158, Total Chunk Time: 0.039 seconds
## Rows Read: 20451, Total Rows Processed: 783609, Total Chunk Time: 0.395 seconds
## Rows Read: 20605, Total Rows Processed: 804214, Total Chunk Time: 0.061 seconds
## Rows Read: 20533, Total Rows Processed: 824747, Total Chunk Time: 0.066 seconds
## Rows Read: 14678, Total Rows Processed: 839425, Total Chunk Time: 0.044 seconds
## Rows Read: 20543, Total Rows Processed: 859968, Total Chunk Time: 0.328 seconds
## Rows Read: 20446, Total Rows Processed: 880414, Total Chunk Time: 0.045 seconds
## Rows Read: 20573, Total Rows Processed: 900987, Total Chunk Time: 0.044 seconds
## Rows Read: 14665, Total Rows Processed: 915652, Total Chunk Time: 0.042 seconds
## Rows Read: 20523, Total Rows Processed: 936175, Total Chunk Time: 0.449 seconds
## Rows Read: 20523, Total Rows Processed: 956698, Total Chunk Time: 0.071 seconds
## Rows Read: 20543, Total Rows Processed: 977241, Total Chunk Time: 0.066 seconds
## Rows Read: 14628, Total Rows Processed: 991869, Total Chunk Time: 0.050 seconds
## Rows Read: 20489, Total Rows Processed: 1012358, Total Chunk Time: 0.356 seconds
## Rows Read: 20521, Total Rows Processed: 1032879, Total Chunk Time: 0.042 seconds
## Rows Read: 20542, Total Rows Processed: 1053421, Total Chunk Time: 0.042 seconds
## Rows Read: 14690, Total Rows Processed: 1068111, Total Chunk Time: 0.043 seconds
## Rows Read: 20514, Total Rows Processed: 1088625, Total Chunk Time: 0.365 seconds
## Rows Read: 20501, Total Rows Processed: 1109126, Total Chunk Time: 0.051 seconds
## Rows Read: 20565, Total Rows Processed: 1129691, Total Chunk Time: 0.051 seconds
## Rows Read: 14654, Total Rows Processed: 1144345, Total Chunk Time: 0.042 seconds
## Rows Read: 20549, Total Rows Processed: 1164894, Total Chunk Time: 0.376 seconds
## Rows Read: 20465, Total Rows Processed: 1185359, Total Chunk Time: 0.047 seconds
## Rows Read: 20527, Total Rows Processed: 1205886, Total Chunk Time: 0.047 seconds
## Rows Read: 14646, Total Rows Processed: 1220532, Total Chunk Time: 0.041 seconds
## Rows Read: 20510, Total Rows Processed: 1241042, Total Chunk Time: 0.373 seconds
## Rows Read: 20576, Total Rows Processed: 1261618, Total Chunk Time: 0.044 seconds
## Rows Read: 20392, Total Rows Processed: 1282010, Total Chunk Time: 0.038 seconds
## Rows Read: 14688, Total Rows Processed: 1296698, Total Chunk Time: 0.038 seconds
## Rows Read: 20511, Total Rows Processed: 1317209, Total Chunk Time: 0.414 seconds
## Rows Read: 20520, Total Rows Processed: 1337729, Total Chunk Time: 0.048 seconds
## Rows Read: 20428, Total Rows Processed: 1358157, Total Chunk Time: 0.041 seconds
## Rows Read: 14674, Total Rows Processed: 1372831, Total Chunk Time: 0.039 seconds
## Rows Read: 20410, Total Rows Processed: 1393241, Total Chunk Time: 0.858 seconds
## Rows Read: 20448, Total Rows Processed: 1413689, Total Chunk Time: 0.049 seconds
## Rows Read: 20614, Total Rows Processed: 1434303, Total Chunk Time: 0.047 seconds
## Rows Read: 14668, Total Rows Processed: 1448971, Total Chunk Time: 0.063 seconds
## Rows Read: 20440, Total Rows Processed: 1469411, Total Chunk Time: 0.321 seconds
## Rows Read: 20558, Total Rows Processed: 1489969, Total Chunk Time: 0.040 seconds
## Rows Read: 20481, Total Rows Processed: 1510450, Total Chunk Time: 0.040 seconds
## Rows Read: 14652, Total Rows Processed: 1525102, Total Chunk Time: 0.038 seconds
## Rows Read: 20498, Total Rows Processed: 1545600, Total Chunk Time: 0.402 seconds
## Rows Read: 20597, Total Rows Processed: 1566197, Total Chunk Time: 0.048 seconds
## Rows Read: 20500, Total Rows Processed: 1586697, Total Chunk Time: 0.046 seconds
## Rows Read: 14590, Total Rows Processed: 1601287, Total Chunk Time: 0.039 seconds
## Rows Read: 20563, Total Rows Processed: 1621850, Total Chunk Time: 0.362 seconds
## Rows Read: 20468, Total Rows Processed: 1642318, Total Chunk Time: 0.042 seconds
## Rows Read: 20504, Total Rows Processed: 1662822, Total Chunk Time: 0.041 seconds
## Rows Read: 14647, Total Rows Processed: 1677469, Total Chunk Time: 0.039 seconds
## Rows Read: 20545, Total Rows Processed: 1698014, Total Chunk Time: 0.341 seconds
## Rows Read: 20521, Total Rows Processed: 1718535, Total Chunk Time: 0.047 seconds
## Rows Read: 20413, Total Rows Processed: 1738948, Total Chunk Time: 0.047 seconds
## Rows Read: 14748, Total Rows Processed: 1753696, Total Chunk Time: 0.044 seconds
## Rows Read: 20503, Total Rows Processed: 1774199, Total Chunk Time: 0.479 seconds
## Rows Read: 20683, Total Rows Processed: 1794882, Total Chunk Time: 0.042 seconds
## Rows Read: 20372, Total Rows Processed: 1815254, Total Chunk Time: 0.040 seconds
## Rows Read: 14649, Total Rows Processed: 1829903, Total Chunk Time: 0.039 seconds
## Rows Read: 20478, Total Rows Processed: 1850381, Total Chunk Time: 0.427 seconds
## Rows Read: 20533, Total Rows Processed: 1870914, Total Chunk Time: 0.047 seconds
## Rows Read: 20581, Total Rows Processed: 1891495, Total Chunk Time: 0.041 seconds
## Rows Read: 14662, Total Rows Processed: 1906157, Total Chunk Time: 0.039 seconds
## Rows Read: 20475, Total Rows Processed: 1926632, Total Chunk Time: 0.315 seconds
## Rows Read: 20514, Total Rows Processed: 1947146, Total Chunk Time: 0.048 seconds
## Rows Read: 20556, Total Rows Processed: 1967702, Total Chunk Time: 0.043 seconds
## Rows Read: 14698, Total Rows Processed: 1982400, Total Chunk Time: 0.046 seconds
## Rows Read: 20581, Total Rows Processed: 2002981, Total Chunk Time: 0.331 seconds
## Rows Read: 20490, Total Rows Processed: 2023471, Total Chunk Time: 0.054 seconds
## Rows Read: 20546, Total Rows Processed: 2044017, Total Chunk Time: 0.057 seconds
## Rows Read: 14635, Total Rows Processed: 2058652, Total Chunk Time: 0.053 seconds
## Rows Read: 20462, Total Rows Processed: 2079114, Total Chunk Time: 0.297 seconds
## Rows Read: 20599, Total Rows Processed: 2099713, Total Chunk Time: 0.045 seconds
## Rows Read: 20516, Total Rows Processed: 2120229, Total Chunk Time: 0.045 seconds
## Rows Read: 14618, Total Rows Processed: 2134847, Total Chunk Time: 0.046 seconds
## Rows Read: 20602, Total Rows Processed: 2155449, Total Chunk Time: 0.396 seconds
## Rows Read: 20582, Total Rows Processed: 2176031, Total Chunk Time: 0.050 seconds
## Rows Read: 20383, Total Rows Processed: 2196414, Total Chunk Time: 0.043 seconds
## Rows Read: 14681, Total Rows Processed: 2211095, Total Chunk Time: 0.041 seconds
## Rows Read: 20561, Total Rows Processed: 2231656, Total Chunk Time: 0.322 seconds
## Rows Read: 20513, Total Rows Processed: 2252169, Total Chunk Time: 0.070 seconds
## Rows Read: 20515, Total Rows Processed: 2272684, Total Chunk Time: 0.068 seconds
## Rows Read: 14641, Total Rows Processed: 2287325, Total Chunk Time: 0.069 seconds
## Rows Read: 20501, Total Rows Processed: 2307826, Total Chunk Time: 0.370 seconds
## Rows Read: 20510, Total Rows Processed: 2328336, Total Chunk Time: 0.051 seconds
## Rows Read: 20608, Total Rows Processed: 2348944, Total Chunk Time: 0.051 seconds
## Rows Read: 14594, Total Rows Processed: 2363538, Total Chunk Time: 0.044 seconds
## Rows Read: 20485, Total Rows Processed: 2384023, Total Chunk Time: 0.807 seconds
## Rows Read: 20523, Total Rows Processed: 2404546, Total Chunk Time: 0.064 seconds
## Rows Read: 20526, Total Rows Processed: 2425072, Total Chunk Time: 0.062 seconds
## Rows Read: 14626, Total Rows Processed: 2439698, Total Chunk Time: 0.061 seconds
## Rows Read: 20549, Total Rows Processed: 2460247, Total Chunk Time: 0.517 seconds
## Rows Read: 20427, Total Rows Processed: 2480674, Total Chunk Time: 0.044 seconds
## Rows Read: 20594, Total Rows Processed: 2501268, Total Chunk Time: 0.042 seconds
## Rows Read: 14637, Total Rows Processed: 2515905, Total Chunk Time: 0.038 seconds
## Rows Read: 20498, Total Rows Processed: 2536403, Total Chunk Time: 0.990 seconds
## Rows Read: 20505, Total Rows Processed: 2556908, Total Chunk Time: 0.064 seconds
## Rows Read: 20444, Total Rows Processed: 2577352, Total Chunk Time: 0.042 seconds
## Rows Read: 14686, Total Rows Processed: 2592038, Total Chunk Time: 0.042 seconds
## Rows Read: 20534, Total Rows Processed: 2612572, Total Chunk Time: 0.381 seconds
## Rows Read: 20404, Total Rows Processed: 2632976, Total Chunk Time: 0.052 seconds
## Rows Read: 20496, Total Rows Processed: 2653472, Total Chunk Time: 0.038 seconds
## Rows Read: 14685, Total Rows Processed: 2668157, Total Chunk Time: 0.038 seconds
## Rows Read: 20582, Total Rows Processed: 2688739, Total Chunk Time: 0.399 seconds
## Rows Read: 20414, Total Rows Processed: 2709153, Total Chunk Time: 0.050 seconds
## Rows Read: 20562, Total Rows Processed: 2729715, Total Chunk Time: 0.050 seconds
## Rows Read: 14598, Total Rows Processed: 2744313, Total Chunk Time: 0.082 seconds
## Rows Read: 20432, Total Rows Processed: 2764745, Total Chunk Time: 0.390 seconds
## Rows Read: 20467, Total Rows Processed: 2785212, Total Chunk Time: 0.044 seconds
## Rows Read: 20623, Total Rows Processed: 2805835, Total Chunk Time: 0.039 seconds
## Rows Read: 14636, Total Rows Processed: 2820471, Total Chunk Time: 0.040 seconds
## Rows Read: 20462, Total Rows Processed: 2840933, Total Chunk Time: 0.789 seconds
## Rows Read: 20517, Total Rows Processed: 2861450, Total Chunk Time: 0.048 seconds
## Rows Read: 20419, Total Rows Processed: 2881869, Total Chunk Time: 0.042 seconds
## Rows Read: 14688, Total Rows Processed: 2896557, Total Chunk Time: 0.041 seconds
## Rows Read: 20451, Total Rows Processed: 2917008, Total Chunk Time: 0.404 seconds
## Rows Read: 20546, Total Rows Processed: 2937554, Total Chunk Time: 0.076 seconds
## Rows Read: 20457, Total Rows Processed: 2958011, Total Chunk Time: 0.047 seconds
## Rows Read: 14651, Total Rows Processed: 2972662, Total Chunk Time: 0.043 seconds
## Rows Read: 20502, Total Rows Processed: 2993164, Total Chunk Time: 0.718 seconds
## Rows Read: 20460, Total Rows Processed: 3013624, Total Chunk Time: 0.055 seconds
## Rows Read: 20477, Total Rows Processed: 3034101, Total Chunk Time: 0.053 seconds
## Rows Read: 14654, Total Rows Processed: 3048755, Total Chunk Time: 0.049 seconds
## Rows Read: 20441, Total Rows Processed: 3069196, Total Chunk Time: 0.978 seconds
## Rows Read: 20479, Total Rows Processed: 3089675, Total Chunk Time: 0.062 seconds
## Rows Read: 20585, Total Rows Processed: 3110260, Total Chunk Time: 0.042 seconds
## Rows Read: 14603, Total Rows Processed: 3124863, Total Chunk Time: 0.045 seconds
## Rows Read: 20452, Total Rows Processed: 3145315, Total Chunk Time: 0.653 seconds
## Rows Read: 20463, Total Rows Processed: 3165778, Total Chunk Time: 0.044 seconds
## Rows Read: 20570, Total Rows Processed: 3186348, Total Chunk Time: 0.043 seconds
## Rows Read: 14622, Total Rows Processed: 3200970, Total Chunk Time: 0.044 seconds
## Rows Read: 20543, Total Rows Processed: 3221513, Total Chunk Time: 0.388 seconds
## Rows Read: 20478, Total Rows Processed: 3241991, Total Chunk Time: 0.050 seconds
## Rows Read: 20462, Total Rows Processed: 3262453, Total Chunk Time: 0.039 seconds
## Rows Read: 14622, Total Rows Processed: 3277075, Total Chunk Time: 0.038 seconds
## Rows Read: 20470, Total Rows Processed: 3297545, Total Chunk Time: 0.328 seconds
## Rows Read: 20517, Total Rows Processed: 3318062, Total Chunk Time: 0.046 seconds
## Rows Read: 20497, Total Rows Processed: 3338559, Total Chunk Time: 0.045 seconds
## Rows Read: 14656, Total Rows Processed: 3353215, Total Chunk Time: 0.040 seconds
## Rows Read: 20446, Total Rows Processed: 3373661, Total Chunk Time: 0.546 seconds
## Rows Read: 20508, Total Rows Processed: 3394169, Total Chunk Time: 0.046 seconds
## Rows Read: 20485, Total Rows Processed: 3414654, Total Chunk Time: 0.040 seconds
## Rows Read: 14667, Total Rows Processed: 3429321, Total Chunk Time: 0.041 seconds
## Rows Read: 20461, Total Rows Processed: 3449782, Total Chunk Time: 0.723 seconds
## Rows Read: 20573, Total Rows Processed: 3470355, Total Chunk Time: 0.054 seconds
## Rows Read: 20482, Total Rows Processed: 3490837, Total Chunk Time: 0.053 seconds
## Rows Read: 14610, Total Rows Processed: 3505447, Total Chunk Time: 0.049 seconds
## Rows Read: 20546, Total Rows Processed: 3525993, Total Chunk Time: 0.826 seconds
## Rows Read: 20562, Total Rows Processed: 3546555, Total Chunk Time: 0.042 seconds
## Rows Read: 20464, Total Rows Processed: 3567019, Total Chunk Time: 0.054 seconds
## Rows Read: 14558, Total Rows Processed: 3581577, Total Chunk Time: 0.047 seconds
## Rows Read: 20512, Total Rows Processed: 3602089, Total Chunk Time: 0.381 seconds
## Rows Read: 20444, Total Rows Processed: 3622533, Total Chunk Time: 0.054 seconds
## Rows Read: 20452, Total Rows Processed: 3642985, Total Chunk Time: 0.041 seconds
## Rows Read: 14697, Total Rows Processed: 3657682, Total Chunk Time: 0.039 seconds
## Rows Read: 20501, Total Rows Processed: 3678183, Total Chunk Time: 0.467 seconds
## Rows Read: 20526, Total Rows Processed: 3698709, Total Chunk Time: 0.063 seconds
## Rows Read: 20543, Total Rows Processed: 3719252, Total Chunk Time: 0.040 seconds
## Rows Read: 14620, Total Rows Processed: 3733872, Total Chunk Time: 0.040 seconds
## Rows Read: 20489, Total Rows Processed: 3754361, Total Chunk Time: 0.336 seconds
## Rows Read: 20596, Total Rows Processed: 3774957, Total Chunk Time: 0.042 seconds
## Rows Read: 20469, Total Rows Processed: 3795426, Total Chunk Time: 0.040 seconds
## Rows Read: 14657, Total Rows Processed: 3810083, Total Chunk Time: 0.039 seconds
## Rows Read: 20469, Total Rows Processed: 3830552, Total Chunk Time: 0.593 seconds
## Rows Read: 20502, Total Rows Processed: 3851054, Total Chunk Time: 0.064 seconds
## Rows Read: 20524, Total Rows Processed: 3871578, Total Chunk Time: 0.040 seconds
## Rows Read: 14694, Total Rows Processed: 3886272, Total Chunk Time: 0.038 seconds
## Rows Read: 20503, Total Rows Processed: 3906775, Total Chunk Time: 0.331 seconds
## Rows Read: 20474, Total Rows Processed: 3927249, Total Chunk Time: 0.040 seconds
## Rows Read: 20573, Total Rows Processed: 3947822, Total Chunk Time: 0.066 seconds
## Rows Read: 14637, Total Rows Processed: 3962459, Total Chunk Time: 0.040 seconds
## Rows Read: 20566, Total Rows Processed: 3983025, Total Chunk Time: 0.331 seconds
## Rows Read: 20441, Total Rows Processed: 4003466, Total Chunk Time: 0.051 seconds
## Rows Read: 20457, Total Rows Processed: 4023923, Total Chunk Time: 0.049 seconds
## Rows Read: 14706, Total Rows Processed: 4038629, Total Chunk Time: 0.042 seconds
## Rows Read: 20459, Total Rows Processed: 4059088, Total Chunk Time: 0.376 seconds
## Rows Read: 20431, Total Rows Processed: 4079519, Total Chunk Time: 0.052 seconds
## Rows Read: 20576, Total Rows Processed: 4100095, Total Chunk Time: 0.051 seconds
## Rows Read: 14680, Total Rows Processed: 4114775, Total Chunk Time: 0.041 seconds
## Rows Read: 20398, Total Rows Processed: 4135173, Total Chunk Time: 0.401 seconds
## Rows Read: 20496, Total Rows Processed: 4155669, Total Chunk Time: 0.046 seconds
## Rows Read: 20517, Total Rows Processed: 4176186, Total Chunk Time: 0.040 seconds
## Rows Read: 14696, Total Rows Processed: 4190882, Total Chunk Time: 0.041 seconds
## Rows Read: 20512, Total Rows Processed: 4211394, Total Chunk Time: 0.373 seconds
## Rows Read: 20466, Total Rows Processed: 4231860, Total Chunk Time: 0.052 seconds
## Rows Read: 20475, Total Rows Processed: 4252335, Total Chunk Time: 0.039 seconds
## Rows Read: 14678, Total Rows Processed: 4267013, Total Chunk Time: 0.040 seconds
## Rows Read: 20550, Total Rows Processed: 4287563, Total Chunk Time: 0.447 seconds
## Rows Read: 20479, Total Rows Processed: 4308042, Total Chunk Time: 0.046 seconds
## Rows Read: 20505, Total Rows Processed: 4328547, Total Chunk Time: 0.045 seconds
## Rows Read: 14669, Total Rows Processed: 4343216, Total Chunk Time: 0.039 seconds
## Rows Read: 20470, Total Rows Processed: 4363686, Total Chunk Time: 0.482 seconds
## Rows Read: 20486, Total Rows Processed: 4384172, Total Chunk Time: 0.070 seconds
## Rows Read: 20511, Total Rows Processed: 4404683, Total Chunk Time: 0.039 seconds
## Rows Read: 14714, Total Rows Processed: 4419397, Total Chunk Time: 0.039 seconds
## Rows Read: 20599, Total Rows Processed: 4439996, Total Chunk Time: 0.390 seconds
## Rows Read: 20501, Total Rows Processed: 4460497, Total Chunk Time: 0.045 seconds
## Rows Read: 20479, Total Rows Processed: 4480976, Total Chunk Time: 0.040 seconds
## Rows Read: 14666, Total Rows Processed: 4495642, Total Chunk Time: 0.041 seconds
## Rows Read: 20540, Total Rows Processed: 4516182, Total Chunk Time: 0.328 seconds
## Rows Read: 20514, Total Rows Processed: 4536696, Total Chunk Time: 0.048 seconds
## Rows Read: 20555, Total Rows Processed: 4557251, Total Chunk Time: 0.048 seconds
## Rows Read: 14687, Total Rows Processed: 4571938, Total Chunk Time: 0.047 seconds
## Rows Read: 20529, Total Rows Processed: 4592467, Total Chunk Time: 0.321 seconds
## Rows Read: 20502, Total Rows Processed: 4612969, Total Chunk Time: 0.046 seconds
## Rows Read: 20628, Total Rows Processed: 4633597, Total Chunk Time: 0.046 seconds
## Rows Read: 14652, Total Rows Processed: 4648249, Total Chunk Time: 0.042 seconds
## Rows Read: 20561, Total Rows Processed: 4668810, Total Chunk Time: 0.354 seconds
## Rows Read: 20461, Total Rows Processed: 4689271, Total Chunk Time: 0.057 seconds
## Rows Read: 20577, Total Rows Processed: 4709848, Total Chunk Time: 0.054 seconds
## Rows Read: 14677, Total Rows Processed: 4724525, Total Chunk Time: 0.044 seconds
## Rows Read: 20501, Total Rows Processed: 4745026, Total Chunk Time: 0.338 seconds
## Rows Read: 20534, Total Rows Processed: 4765560, Total Chunk Time: 0.047 seconds
## Rows Read: 20551, Total Rows Processed: 4786111, Total Chunk Time: 0.043 seconds
## Rows Read: 14707, Total Rows Processed: 4800818, Total Chunk Time: 0.044 seconds
## Rows Read: 20572, Total Rows Processed: 4821390, Total Chunk Time: 0.487 seconds
## Rows Read: 20409, Total Rows Processed: 4841799, Total Chunk Time: 0.056 seconds
## Rows Read: 20578, Total Rows Processed: 4862377, Total Chunk Time: 0.056 seconds
## Rows Read: 14695, Total Rows Processed: 4877072, Total Chunk Time: 0.044 seconds
## Rows Read: 20500, Total Rows Processed: 4897572, Total Chunk Time: 0.324 seconds
## Rows Read: 20577, Total Rows Processed: 4918149, Total Chunk Time: 0.045 seconds
## Rows Read: 20487, Total Rows Processed: 4938636, Total Chunk Time: 0.039 seconds
## Rows Read: 14719, Total Rows Processed: 4953355, Total Chunk Time: 0.040 seconds
## Rows Read: 20523, Total Rows Processed: 4973878, Total Chunk Time: 0.493 seconds
## Rows Read: 20520, Total Rows Processed: 4994398, Total Chunk Time: 0.045 seconds
## Rows Read: 20442, Total Rows Processed: 5014840, Total Chunk Time: 0.041 seconds
## Rows Read: 14749, Total Rows Processed: 5029589, Total Chunk Time: 0.038 seconds
## Rows Read: 20483, Total Rows Processed: 5050072, Total Chunk Time: 0.328 seconds
## Rows Read: 20539, Total Rows Processed: 5070611, Total Chunk Time: 0.040 seconds
## Rows Read: 20484, Total Rows Processed: 5091095, Total Chunk Time: 0.040 seconds
## Rows Read: 14709, Total Rows Processed: 5105804, Total Chunk Time: 0.039 seconds
## Rows Read: 20568, Total Rows Processed: 5126372, Total Chunk Time: 0.373 seconds
## Rows Read: 20510, Total Rows Processed: 5146882, Total Chunk Time: 0.059 seconds
## Rows Read: 20522, Total Rows Processed: 5167404, Total Chunk Time: 0.059 seconds
## Rows Read: 14676, Total Rows Processed: 5182080, Total Chunk Time: 0.060 seconds
## Rows Read: 20456, Total Rows Processed: 5202536, Total Chunk Time: 0.292 seconds
## Rows Read: 20565, Total Rows Processed: 5223101, Total Chunk Time: 0.041 seconds
## Rows Read: 20536, Total Rows Processed: 5243637, Total Chunk Time: 0.042 seconds
## Rows Read: 14675, Total Rows Processed: 5258312, Total Chunk Time: 0.040 seconds
## Rows Read: 20454, Total Rows Processed: 5278766, Total Chunk Time: 1.445 seconds
## Rows Read: 20536, Total Rows Processed: 5299302, Total Chunk Time: 0.073 seconds
## Rows Read: 20536, Total Rows Processed: 5319838, Total Chunk Time: 0.071 seconds
## Rows Read: 14690, Total Rows Processed: 5334528, Total Chunk Time: 0.072 seconds
## Rows Read: 20538, Total Rows Processed: 5355066, Total Chunk Time: 0.347 seconds
## Rows Read: 20455, Total Rows Processed: 5375521, Total Chunk Time: 0.045 seconds
## Rows Read: 20553, Total Rows Processed: 5396074, Total Chunk Time: 0.041 seconds
## Rows Read: 14626, Total Rows Processed: 5410700, Total Chunk Time: 0.040 seconds
## Rows Read: 20513, Total Rows Processed: 5431213, Total Chunk Time: 0.357 seconds
## Rows Read: 20447, Total Rows Processed: 5451660, Total Chunk Time: 0.046 seconds
## Rows Read: 20480, Total Rows Processed: 5472140, Total Chunk Time: 0.044 seconds
## Rows Read: 14663, Total Rows Processed: 5486803, Total Chunk Time: 0.042 seconds
## Rows Read: 20481, Total Rows Processed: 5507284, Total Chunk Time: 0.297 seconds
## Rows Read: 20471, Total Rows Processed: 5527755, Total Chunk Time: 0.040 seconds
## Rows Read: 20462, Total Rows Processed: 5548217, Total Chunk Time: 0.039 seconds
## Rows Read: 14735, Total Rows Processed: 5562952, Total Chunk Time: 0.039 seconds
## Rows Read: 20398, Total Rows Processed: 5583350, Total Chunk Time: 0.370 seconds
## Rows Read: 20458, Total Rows Processed: 5603808, Total Chunk Time: 0.050 seconds
## Rows Read: 20644, Total Rows Processed: 5624452, Total Chunk Time: 0.050 seconds
## Rows Read: 14686, Total Rows Processed: 5639138, Total Chunk Time: 0.052 seconds
## Rows Read: 20541, Total Rows Processed: 5659679, Total Chunk Time: 0.385 seconds
## Rows Read: 20462, Total Rows Processed: 5680141, Total Chunk Time: 0.040 seconds
## Rows Read: 20508, Total Rows Processed: 5700649, Total Chunk Time: 0.039 seconds
## Rows Read: 14695, Total Rows Processed: 5715344, Total Chunk Time: 0.039 seconds
## Rows Read: 20432, Total Rows Processed: 5735776, Total Chunk Time: 0.509 seconds
## Rows Read: 20512, Total Rows Processed: 5756288, Total Chunk Time: 0.041 seconds
## Rows Read: 20556, Total Rows Processed: 5776844, Total Chunk Time: 0.040 seconds
## Rows Read: 14700, Total Rows Processed: 5791544, Total Chunk Time: 0.038 seconds
## Rows Read: 20536, Total Rows Processed: 5812080, Total Chunk Time: 1.083 seconds
## Rows Read: 20490, Total Rows Processed: 5832570, Total Chunk Time: 0.060 seconds
## Rows Read: 20605, Total Rows Processed: 5853175, Total Chunk Time: 0.059 seconds
## Rows Read: 14617, Total Rows Processed: 5867792, Total Chunk Time: 0.057 seconds
## Rows Read: 20494, Total Rows Processed: 5888286, Total Chunk Time: 6.772 seconds
## Rows Read: 20573, Total Rows Processed: 5908859, Total Chunk Time: 0.072 seconds
## Rows Read: 20502, Total Rows Processed: 5929361, Total Chunk Time: 0.069 seconds
## Rows Read: 14718, Total Rows Processed: 5944079, Total Chunk Time: 0.068 seconds
## Rows Read: 20501, Total Rows Processed: 5964580, Total Chunk Time: 0.909 seconds
## Rows Read: 20500, Total Rows Processed: 5985080, Total Chunk Time: 0.057 seconds
## Rows Read: 20610, Total Rows Processed: 6005690, Total Chunk Time: 0.039 seconds
## Rows Read: 14721, Total Rows Processed: 6020411, Total Chunk Time: 0.040 seconds
## Rows Read: 20527, Total Rows Processed: 6040938, Total Chunk Time: 3.209 seconds
## Rows Read: 20594, Total Rows Processed: 6061532, Total Chunk Time: 0.075 seconds
## Rows Read: 20555, Total Rows Processed: 6082087, Total Chunk Time: 0.057 seconds
## Rows Read: 14675, Total Rows Processed: 6096762, Total Chunk Time: 0.042 seconds</code></pre>
<pre><code>##    user  system elapsed 
##   0.184   0.012  70.822</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># user  system elapsed </span>
<span class="co"># 13.436   3.616 142.326</span>


logitPredict &lt;-<span class="st"> </span><span class="kw">RxXdfData</span>(<span class="kw">file.path</span>(dataDir, <span class="st">&quot;logitPredict&quot;</span>),
                          <span class="dt">fileSystem =</span> hdfsFS)

<span class="kw">rxPredict</span>(logitModel, <span class="dt">data =</span> testDS, <span class="dt">outData =</span> logitPredict,
          <span class="dt">extraVarsToWrite =</span> <span class="kw">c</span>(<span class="st">&quot;ArrDel15&quot;</span>),
          <span class="dt">type =</span> <span class="st">&#39;response&#39;</span>, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Rows Read: 20577, Total Rows Processed: 20577, Total Chunk Time: 1.908 seconds
## Rows Read: 20524, Total Rows Processed: 41101, Total Chunk Time: 6.531 seconds
## Rows Read: 20487, Total Rows Processed: 61588, Total Chunk Time: 0.038 seconds
## Rows Read: 14729, Total Rows Processed: 76317, Total Chunk Time: 0.033 seconds
## Rows Read: 20509, Total Rows Processed: 96826, Total Chunk Time: 0.365 seconds
## Rows Read: 20455, Total Rows Processed: 117281, Total Chunk Time: 0.043 seconds
## Rows Read: 20623, Total Rows Processed: 137904, Total Chunk Time: 0.043 seconds
## Rows Read: 14643, Total Rows Processed: 152547, Total Chunk Time: 0.040 seconds
## Rows Read: 20513, Total Rows Processed: 173060, Total Chunk Time: 0.321 seconds
## Rows Read: 20587, Total Rows Processed: 193647, Total Chunk Time: 0.039 seconds
## Rows Read: 20583, Total Rows Processed: 214230, Total Chunk Time: 0.031 seconds
## Rows Read: 14622, Total Rows Processed: 228852, Total Chunk Time: 0.023 seconds
## Rows Read: 20532, Total Rows Processed: 249384, Total Chunk Time: 0.367 seconds
## Rows Read: 20500, Total Rows Processed: 269884, Total Chunk Time: 0.033 seconds
## Rows Read: 20609, Total Rows Processed: 290493, Total Chunk Time: 0.029 seconds
## Rows Read: 14703, Total Rows Processed: 305196, Total Chunk Time: 0.024 seconds
## Rows Read: 20573, Total Rows Processed: 325769, Total Chunk Time: 0.344 seconds
## Rows Read: 20516, Total Rows Processed: 346285, Total Chunk Time: 0.029 seconds
## Rows Read: 20584, Total Rows Processed: 366869, Total Chunk Time: 0.026 seconds
## Rows Read: 14682, Total Rows Processed: 381551, Total Chunk Time: 0.023 seconds
## Rows Read: 20569, Total Rows Processed: 402120, Total Chunk Time: 0.362 seconds
## Rows Read: 20514, Total Rows Processed: 422634, Total Chunk Time: 0.030 seconds
## Rows Read: 20588, Total Rows Processed: 443222, Total Chunk Time: 0.028 seconds
## Rows Read: 14649, Total Rows Processed: 457871, Total Chunk Time: 0.024 seconds
## Rows Read: 20520, Total Rows Processed: 478391, Total Chunk Time: 0.282 seconds
## Rows Read: 20495, Total Rows Processed: 498886, Total Chunk Time: 0.027 seconds
## Rows Read: 20651, Total Rows Processed: 519537, Total Chunk Time: 0.026 seconds
## Rows Read: 14678, Total Rows Processed: 534215, Total Chunk Time: 0.023 seconds
## Rows Read: 20525, Total Rows Processed: 554740, Total Chunk Time: 0.309 seconds
## Rows Read: 20535, Total Rows Processed: 575275, Total Chunk Time: 0.027 seconds
## Rows Read: 20575, Total Rows Processed: 595850, Total Chunk Time: 0.025 seconds
## Rows Read: 14686, Total Rows Processed: 610536, Total Chunk Time: 0.024 seconds
## Rows Read: 20585, Total Rows Processed: 631121, Total Chunk Time: 0.304 seconds
## Rows Read: 20456, Total Rows Processed: 651577, Total Chunk Time: 0.028 seconds
## Rows Read: 20564, Total Rows Processed: 672141, Total Chunk Time: 0.027 seconds
## Rows Read: 14710, Total Rows Processed: 686851, Total Chunk Time: 0.024 seconds
## Rows Read: 20561, Total Rows Processed: 707412, Total Chunk Time: 0.302 seconds
## Rows Read: 20506, Total Rows Processed: 727918, Total Chunk Time: 0.033 seconds
## Rows Read: 20560, Total Rows Processed: 748478, Total Chunk Time: 0.028 seconds
## Rows Read: 14680, Total Rows Processed: 763158, Total Chunk Time: 0.025 seconds
## Rows Read: 20451, Total Rows Processed: 783609, Total Chunk Time: 0.350 seconds
## Rows Read: 20605, Total Rows Processed: 804214, Total Chunk Time: 0.028 seconds
## Rows Read: 20533, Total Rows Processed: 824747, Total Chunk Time: 0.027 seconds
## Rows Read: 14678, Total Rows Processed: 839425, Total Chunk Time: 0.026 seconds
## Rows Read: 20543, Total Rows Processed: 859968, Total Chunk Time: 0.334 seconds
## Rows Read: 20446, Total Rows Processed: 880414, Total Chunk Time: 0.027 seconds
## Rows Read: 20573, Total Rows Processed: 900987, Total Chunk Time: 0.026 seconds
## Rows Read: 14665, Total Rows Processed: 915652, Total Chunk Time: 0.023 seconds
## Rows Read: 20523, Total Rows Processed: 936175, Total Chunk Time: 0.305 seconds
## Rows Read: 20523, Total Rows Processed: 956698, Total Chunk Time: 0.033 seconds
## Rows Read: 20543, Total Rows Processed: 977241, Total Chunk Time: 0.026 seconds
## Rows Read: 14628, Total Rows Processed: 991869, Total Chunk Time: 0.023 seconds
## Rows Read: 20489, Total Rows Processed: 1012358, Total Chunk Time: 0.311 seconds
## Rows Read: 20521, Total Rows Processed: 1032879, Total Chunk Time: 0.032 seconds
## Rows Read: 20542, Total Rows Processed: 1053421, Total Chunk Time: 0.029 seconds
## Rows Read: 14690, Total Rows Processed: 1068111, Total Chunk Time: 0.025 seconds
## Rows Read: 20514, Total Rows Processed: 1088625, Total Chunk Time: 0.445 seconds
## Rows Read: 20501, Total Rows Processed: 1109126, Total Chunk Time: 0.029 seconds
## Rows Read: 20565, Total Rows Processed: 1129691, Total Chunk Time: 0.026 seconds
## Rows Read: 14654, Total Rows Processed: 1144345, Total Chunk Time: 0.023 seconds
## Rows Read: 20549, Total Rows Processed: 1164894, Total Chunk Time: 0.422 seconds
## Rows Read: 20465, Total Rows Processed: 1185359, Total Chunk Time: 0.036 seconds
## Rows Read: 20527, Total Rows Processed: 1205886, Total Chunk Time: 0.027 seconds
## Rows Read: 14646, Total Rows Processed: 1220532, Total Chunk Time: 0.024 seconds
## Rows Read: 20510, Total Rows Processed: 1241042, Total Chunk Time: 0.656 seconds
## Rows Read: 20576, Total Rows Processed: 1261618, Total Chunk Time: 0.027 seconds
## Rows Read: 20392, Total Rows Processed: 1282010, Total Chunk Time: 0.025 seconds
## Rows Read: 14688, Total Rows Processed: 1296698, Total Chunk Time: 0.022 seconds
## Rows Read: 20511, Total Rows Processed: 1317209, Total Chunk Time: 0.501 seconds
## Rows Read: 20520, Total Rows Processed: 1337729, Total Chunk Time: 0.043 seconds
## Rows Read: 20428, Total Rows Processed: 1358157, Total Chunk Time: 0.041 seconds
## Rows Read: 14674, Total Rows Processed: 1372831, Total Chunk Time: 0.036 seconds
## Rows Read: 20410, Total Rows Processed: 1393241, Total Chunk Time: 0.313 seconds
## Rows Read: 20448, Total Rows Processed: 1413689, Total Chunk Time: 0.027 seconds
## Rows Read: 20614, Total Rows Processed: 1434303, Total Chunk Time: 0.027 seconds
## Rows Read: 14668, Total Rows Processed: 1448971, Total Chunk Time: 0.023 seconds
## Rows Read: 20440, Total Rows Processed: 1469411, Total Chunk Time: 0.363 seconds
## Rows Read: 20558, Total Rows Processed: 1489969, Total Chunk Time: 0.032 seconds
## Rows Read: 20481, Total Rows Processed: 1510450, Total Chunk Time: 0.031 seconds
## Rows Read: 14652, Total Rows Processed: 1525102, Total Chunk Time: 0.027 seconds
## Rows Read: 20498, Total Rows Processed: 1545600, Total Chunk Time: 0.367 seconds
## Rows Read: 20597, Total Rows Processed: 1566197, Total Chunk Time: 0.028 seconds
## Rows Read: 20500, Total Rows Processed: 1586697, Total Chunk Time: 0.026 seconds
## Rows Read: 14590, Total Rows Processed: 1601287, Total Chunk Time: 0.023 seconds
## Rows Read: 20563, Total Rows Processed: 1621850, Total Chunk Time: 0.390 seconds
## Rows Read: 20468, Total Rows Processed: 1642318, Total Chunk Time: 0.034 seconds
## Rows Read: 20504, Total Rows Processed: 1662822, Total Chunk Time: 0.030 seconds
## Rows Read: 14647, Total Rows Processed: 1677469, Total Chunk Time: 0.026 seconds
## Rows Read: 20545, Total Rows Processed: 1698014, Total Chunk Time: 0.367 seconds
## Rows Read: 20521, Total Rows Processed: 1718535, Total Chunk Time: 0.027 seconds
## Rows Read: 20413, Total Rows Processed: 1738948, Total Chunk Time: 0.026 seconds
## Rows Read: 14748, Total Rows Processed: 1753696, Total Chunk Time: 0.023 seconds
## Rows Read: 20503, Total Rows Processed: 1774199, Total Chunk Time: 0.493 seconds
## Rows Read: 20683, Total Rows Processed: 1794882, Total Chunk Time: 0.030 seconds
## Rows Read: 20372, Total Rows Processed: 1815254, Total Chunk Time: 0.029 seconds
## Rows Read: 14649, Total Rows Processed: 1829903, Total Chunk Time: 0.023 seconds
## Rows Read: 20478, Total Rows Processed: 1850381, Total Chunk Time: 0.518 seconds
## Rows Read: 20533, Total Rows Processed: 1870914, Total Chunk Time: 0.028 seconds
## Rows Read: 20581, Total Rows Processed: 1891495, Total Chunk Time: 0.027 seconds
## Rows Read: 14662, Total Rows Processed: 1906157, Total Chunk Time: 0.023 seconds
## Rows Read: 20475, Total Rows Processed: 1926632, Total Chunk Time: 0.321 seconds
## Rows Read: 20514, Total Rows Processed: 1947146, Total Chunk Time: 0.028 seconds
## Rows Read: 20556, Total Rows Processed: 1967702, Total Chunk Time: 0.030 seconds
## Rows Read: 14698, Total Rows Processed: 1982400, Total Chunk Time: 0.025 seconds
## Rows Read: 20581, Total Rows Processed: 2002981, Total Chunk Time: 0.362 seconds
## Rows Read: 20490, Total Rows Processed: 2023471, Total Chunk Time: 0.029 seconds
## Rows Read: 20546, Total Rows Processed: 2044017, Total Chunk Time: 0.027 seconds
## Rows Read: 14635, Total Rows Processed: 2058652, Total Chunk Time: 0.024 seconds
## Rows Read: 20462, Total Rows Processed: 2079114, Total Chunk Time: 0.306 seconds
## Rows Read: 20599, Total Rows Processed: 2099713, Total Chunk Time: 0.034 seconds
## Rows Read: 20516, Total Rows Processed: 2120229, Total Chunk Time: 0.030 seconds
## Rows Read: 14618, Total Rows Processed: 2134847, Total Chunk Time: 0.026 seconds
## Rows Read: 20602, Total Rows Processed: 2155449, Total Chunk Time: 0.266 seconds
## Rows Read: 20582, Total Rows Processed: 2176031, Total Chunk Time: 0.027 seconds
## Rows Read: 20383, Total Rows Processed: 2196414, Total Chunk Time: 0.026 seconds
## Rows Read: 14681, Total Rows Processed: 2211095, Total Chunk Time: 0.027 seconds
## Rows Read: 20561, Total Rows Processed: 2231656, Total Chunk Time: 0.323 seconds
## Rows Read: 20513, Total Rows Processed: 2252169, Total Chunk Time: 0.028 seconds
## Rows Read: 20515, Total Rows Processed: 2272684, Total Chunk Time: 0.028 seconds
## Rows Read: 14641, Total Rows Processed: 2287325, Total Chunk Time: 0.024 seconds
## Rows Read: 20501, Total Rows Processed: 2307826, Total Chunk Time: 0.296 seconds
## Rows Read: 20510, Total Rows Processed: 2328336, Total Chunk Time: 0.030 seconds
## Rows Read: 20608, Total Rows Processed: 2348944, Total Chunk Time: 0.038 seconds
## Rows Read: 14594, Total Rows Processed: 2363538, Total Chunk Time: 0.044 seconds
## Rows Read: 20485, Total Rows Processed: 2384023, Total Chunk Time: 0.544 seconds
## Rows Read: 20523, Total Rows Processed: 2404546, Total Chunk Time: 0.042 seconds
## Rows Read: 20526, Total Rows Processed: 2425072, Total Chunk Time: 0.040 seconds
## Rows Read: 14626, Total Rows Processed: 2439698, Total Chunk Time: 0.033 seconds
## Rows Read: 20549, Total Rows Processed: 2460247, Total Chunk Time: 0.512 seconds
## Rows Read: 20427, Total Rows Processed: 2480674, Total Chunk Time: 0.030 seconds
## Rows Read: 20594, Total Rows Processed: 2501268, Total Chunk Time: 0.028 seconds
## Rows Read: 14637, Total Rows Processed: 2515905, Total Chunk Time: 0.024 seconds
## Rows Read: 20498, Total Rows Processed: 2536403, Total Chunk Time: 0.395 seconds
## Rows Read: 20505, Total Rows Processed: 2556908, Total Chunk Time: 0.034 seconds
## Rows Read: 20444, Total Rows Processed: 2577352, Total Chunk Time: 0.030 seconds
## Rows Read: 14686, Total Rows Processed: 2592038, Total Chunk Time: 0.027 seconds
## Rows Read: 20534, Total Rows Processed: 2612572, Total Chunk Time: 0.731 seconds
## Rows Read: 20404, Total Rows Processed: 2632976, Total Chunk Time: 0.046 seconds
## Rows Read: 20496, Total Rows Processed: 2653472, Total Chunk Time: 0.041 seconds
## Rows Read: 14685, Total Rows Processed: 2668157, Total Chunk Time: 0.032 seconds
## Rows Read: 20582, Total Rows Processed: 2688739, Total Chunk Time: 1.046 seconds
## Rows Read: 20414, Total Rows Processed: 2709153, Total Chunk Time: 0.033 seconds
## Rows Read: 20562, Total Rows Processed: 2729715, Total Chunk Time: 0.031 seconds
## Rows Read: 14598, Total Rows Processed: 2744313, Total Chunk Time: 0.035 seconds
## Rows Read: 20432, Total Rows Processed: 2764745, Total Chunk Time: 0.448 seconds
## Rows Read: 20467, Total Rows Processed: 2785212, Total Chunk Time: 0.030 seconds
## Rows Read: 20623, Total Rows Processed: 2805835, Total Chunk Time: 0.030 seconds
## Rows Read: 14636, Total Rows Processed: 2820471, Total Chunk Time: 0.026 seconds
## Rows Read: 20462, Total Rows Processed: 2840933, Total Chunk Time: 0.341 seconds
## Rows Read: 20517, Total Rows Processed: 2861450, Total Chunk Time: 0.027 seconds
## Rows Read: 20419, Total Rows Processed: 2881869, Total Chunk Time: 0.026 seconds
## Rows Read: 14688, Total Rows Processed: 2896557, Total Chunk Time: 0.024 seconds
## Rows Read: 20451, Total Rows Processed: 2917008, Total Chunk Time: 0.507 seconds
## Rows Read: 20546, Total Rows Processed: 2937554, Total Chunk Time: 0.029 seconds
## Rows Read: 20457, Total Rows Processed: 2958011, Total Chunk Time: 0.027 seconds
## Rows Read: 14651, Total Rows Processed: 2972662, Total Chunk Time: 0.024 seconds
## Rows Read: 20502, Total Rows Processed: 2993164, Total Chunk Time: 0.388 seconds
## Rows Read: 20460, Total Rows Processed: 3013624, Total Chunk Time: 0.027 seconds
## Rows Read: 20477, Total Rows Processed: 3034101, Total Chunk Time: 0.036 seconds
## Rows Read: 14654, Total Rows Processed: 3048755, Total Chunk Time: 0.023 seconds
## Rows Read: 20441, Total Rows Processed: 3069196, Total Chunk Time: 0.415 seconds
## Rows Read: 20479, Total Rows Processed: 3089675, Total Chunk Time: 0.026 seconds
## Rows Read: 20585, Total Rows Processed: 3110260, Total Chunk Time: 0.027 seconds
## Rows Read: 14603, Total Rows Processed: 3124863, Total Chunk Time: 0.023 seconds
## Rows Read: 20452, Total Rows Processed: 3145315, Total Chunk Time: 0.326 seconds
## Rows Read: 20463, Total Rows Processed: 3165778, Total Chunk Time: 0.031 seconds
## Rows Read: 20570, Total Rows Processed: 3186348, Total Chunk Time: 0.031 seconds
## Rows Read: 14622, Total Rows Processed: 3200970, Total Chunk Time: 0.026 seconds
## Rows Read: 20543, Total Rows Processed: 3221513, Total Chunk Time: 0.334 seconds
## Rows Read: 20478, Total Rows Processed: 3241991, Total Chunk Time: 0.027 seconds
## Rows Read: 20462, Total Rows Processed: 3262453, Total Chunk Time: 0.026 seconds
## Rows Read: 14622, Total Rows Processed: 3277075, Total Chunk Time: 0.027 seconds
## Rows Read: 20470, Total Rows Processed: 3297545, Total Chunk Time: 0.443 seconds
## Rows Read: 20517, Total Rows Processed: 3318062, Total Chunk Time: 0.028 seconds
## Rows Read: 20497, Total Rows Processed: 3338559, Total Chunk Time: 0.026 seconds
## Rows Read: 14656, Total Rows Processed: 3353215, Total Chunk Time: 0.023 seconds
## Rows Read: 20446, Total Rows Processed: 3373661, Total Chunk Time: 0.350 seconds
## Rows Read: 20508, Total Rows Processed: 3394169, Total Chunk Time: 0.031 seconds
## Rows Read: 20485, Total Rows Processed: 3414654, Total Chunk Time: 0.030 seconds
## Rows Read: 14667, Total Rows Processed: 3429321, Total Chunk Time: 0.025 seconds
## Rows Read: 20461, Total Rows Processed: 3449782, Total Chunk Time: 0.354 seconds
## Rows Read: 20573, Total Rows Processed: 3470355, Total Chunk Time: 0.026 seconds
## Rows Read: 20482, Total Rows Processed: 3490837, Total Chunk Time: 0.034 seconds
## Rows Read: 14610, Total Rows Processed: 3505447, Total Chunk Time: 0.024 seconds
## Rows Read: 20546, Total Rows Processed: 3525993, Total Chunk Time: 0.815 seconds
## Rows Read: 20562, Total Rows Processed: 3546555, Total Chunk Time: 0.036 seconds
## Rows Read: 20464, Total Rows Processed: 3567019, Total Chunk Time: 0.033 seconds
## Rows Read: 14558, Total Rows Processed: 3581577, Total Chunk Time: 0.031 seconds
## Rows Read: 20512, Total Rows Processed: 3602089, Total Chunk Time: 0.387 seconds
## Rows Read: 20444, Total Rows Processed: 3622533, Total Chunk Time: 0.035 seconds
## Rows Read: 20452, Total Rows Processed: 3642985, Total Chunk Time: 0.034 seconds
## Rows Read: 14697, Total Rows Processed: 3657682, Total Chunk Time: 0.034 seconds
## Rows Read: 20501, Total Rows Processed: 3678183, Total Chunk Time: 0.654 seconds
## Rows Read: 20526, Total Rows Processed: 3698709, Total Chunk Time: 0.029 seconds
## Rows Read: 20543, Total Rows Processed: 3719252, Total Chunk Time: 0.026 seconds
## Rows Read: 14620, Total Rows Processed: 3733872, Total Chunk Time: 0.023 seconds
## Rows Read: 20489, Total Rows Processed: 3754361, Total Chunk Time: 0.306 seconds
## Rows Read: 20596, Total Rows Processed: 3774957, Total Chunk Time: 0.030 seconds
## Rows Read: 20469, Total Rows Processed: 3795426, Total Chunk Time: 0.028 seconds
## Rows Read: 14657, Total Rows Processed: 3810083, Total Chunk Time: 0.026 seconds
## Rows Read: 20469, Total Rows Processed: 3830552, Total Chunk Time: 0.362 seconds
## Rows Read: 20502, Total Rows Processed: 3851054, Total Chunk Time: 0.030 seconds
## Rows Read: 20524, Total Rows Processed: 3871578, Total Chunk Time: 0.028 seconds
## Rows Read: 14694, Total Rows Processed: 3886272, Total Chunk Time: 0.023 seconds
## Rows Read: 20503, Total Rows Processed: 3906775, Total Chunk Time: 0.331 seconds
## Rows Read: 20474, Total Rows Processed: 3927249, Total Chunk Time: 0.033 seconds
## Rows Read: 20573, Total Rows Processed: 3947822, Total Chunk Time: 0.031 seconds
## Rows Read: 14637, Total Rows Processed: 3962459, Total Chunk Time: 0.028 seconds
## Rows Read: 20566, Total Rows Processed: 3983025, Total Chunk Time: 0.294 seconds
## Rows Read: 20441, Total Rows Processed: 4003466, Total Chunk Time: 0.027 seconds
## Rows Read: 20457, Total Rows Processed: 4023923, Total Chunk Time: 0.026 seconds
## Rows Read: 14706, Total Rows Processed: 4038629, Total Chunk Time: 0.023 seconds
## Rows Read: 20459, Total Rows Processed: 4059088, Total Chunk Time: 0.370 seconds
## Rows Read: 20431, Total Rows Processed: 4079519, Total Chunk Time: 0.030 seconds
## Rows Read: 20576, Total Rows Processed: 4100095, Total Chunk Time: 0.029 seconds
## Rows Read: 14680, Total Rows Processed: 4114775, Total Chunk Time: 0.025 seconds
## Rows Read: 20398, Total Rows Processed: 4135173, Total Chunk Time: 0.390 seconds
## Rows Read: 20496, Total Rows Processed: 4155669, Total Chunk Time: 0.026 seconds
## Rows Read: 20517, Total Rows Processed: 4176186, Total Chunk Time: 0.026 seconds
## Rows Read: 14696, Total Rows Processed: 4190882, Total Chunk Time: 0.025 seconds
## Rows Read: 20512, Total Rows Processed: 4211394, Total Chunk Time: 0.319 seconds
## Rows Read: 20466, Total Rows Processed: 4231860, Total Chunk Time: 0.028 seconds
## Rows Read: 20475, Total Rows Processed: 4252335, Total Chunk Time: 0.028 seconds
## Rows Read: 14678, Total Rows Processed: 4267013, Total Chunk Time: 0.025 seconds
## Rows Read: 20550, Total Rows Processed: 4287563, Total Chunk Time: 0.335 seconds
## Rows Read: 20479, Total Rows Processed: 4308042, Total Chunk Time: 0.028 seconds
## Rows Read: 20505, Total Rows Processed: 4328547, Total Chunk Time: 0.027 seconds
## Rows Read: 14669, Total Rows Processed: 4343216, Total Chunk Time: 0.023 seconds
## Rows Read: 20470, Total Rows Processed: 4363686, Total Chunk Time: 0.315 seconds
## Rows Read: 20486, Total Rows Processed: 4384172, Total Chunk Time: 0.028 seconds
## Rows Read: 20511, Total Rows Processed: 4404683, Total Chunk Time: 0.025 seconds
## Rows Read: 14714, Total Rows Processed: 4419397, Total Chunk Time: 0.021 seconds
## Rows Read: 20599, Total Rows Processed: 4439996, Total Chunk Time: 0.403 seconds
## Rows Read: 20501, Total Rows Processed: 4460497, Total Chunk Time: 0.030 seconds
## Rows Read: 20479, Total Rows Processed: 4480976, Total Chunk Time: 0.030 seconds
## Rows Read: 14666, Total Rows Processed: 4495642, Total Chunk Time: 0.027 seconds
## Rows Read: 20540, Total Rows Processed: 4516182, Total Chunk Time: 0.658 seconds
## Rows Read: 20514, Total Rows Processed: 4536696, Total Chunk Time: 0.035 seconds
## Rows Read: 20555, Total Rows Processed: 4557251, Total Chunk Time: 0.032 seconds
## Rows Read: 14687, Total Rows Processed: 4571938, Total Chunk Time: 0.028 seconds
## Rows Read: 20529, Total Rows Processed: 4592467, Total Chunk Time: 0.325 seconds
## Rows Read: 20502, Total Rows Processed: 4612969, Total Chunk Time: 0.036 seconds
## Rows Read: 20628, Total Rows Processed: 4633597, Total Chunk Time: 0.038 seconds
## Rows Read: 14652, Total Rows Processed: 4648249, Total Chunk Time: 0.032 seconds
## Rows Read: 20561, Total Rows Processed: 4668810, Total Chunk Time: 0.301 seconds
## Rows Read: 20461, Total Rows Processed: 4689271, Total Chunk Time: 0.028 seconds
## Rows Read: 20577, Total Rows Processed: 4709848, Total Chunk Time: 0.027 seconds
## Rows Read: 14677, Total Rows Processed: 4724525, Total Chunk Time: 0.024 seconds
## Rows Read: 20501, Total Rows Processed: 4745026, Total Chunk Time: 0.384 seconds
## Rows Read: 20534, Total Rows Processed: 4765560, Total Chunk Time: 0.028 seconds
## Rows Read: 20551, Total Rows Processed: 4786111, Total Chunk Time: 0.033 seconds
## Rows Read: 14707, Total Rows Processed: 4800818, Total Chunk Time: 0.024 seconds
## Rows Read: 20572, Total Rows Processed: 4821390, Total Chunk Time: 0.318 seconds
## Rows Read: 20409, Total Rows Processed: 4841799, Total Chunk Time: 0.028 seconds
## Rows Read: 20578, Total Rows Processed: 4862377, Total Chunk Time: 0.027 seconds
## Rows Read: 14695, Total Rows Processed: 4877072, Total Chunk Time: 0.024 seconds
## Rows Read: 20500, Total Rows Processed: 4897572, Total Chunk Time: 0.279 seconds
## Rows Read: 20577, Total Rows Processed: 4918149, Total Chunk Time: 0.024 seconds
## Rows Read: 20487, Total Rows Processed: 4938636, Total Chunk Time: 0.029 seconds
## Rows Read: 14719, Total Rows Processed: 4953355, Total Chunk Time: 0.025 seconds
## Rows Read: 20523, Total Rows Processed: 4973878, Total Chunk Time: 0.297 seconds
## Rows Read: 20520, Total Rows Processed: 4994398, Total Chunk Time: 0.037 seconds
## Rows Read: 20442, Total Rows Processed: 5014840, Total Chunk Time: 0.031 seconds
## Rows Read: 14749, Total Rows Processed: 5029589, Total Chunk Time: 0.027 seconds
## Rows Read: 20483, Total Rows Processed: 5050072, Total Chunk Time: 0.331 seconds
## Rows Read: 20539, Total Rows Processed: 5070611, Total Chunk Time: 0.026 seconds
## Rows Read: 20484, Total Rows Processed: 5091095, Total Chunk Time: 0.026 seconds
## Rows Read: 14709, Total Rows Processed: 5105804, Total Chunk Time: 0.023 seconds
## Rows Read: 20568, Total Rows Processed: 5126372, Total Chunk Time: 0.347 seconds
## Rows Read: 20510, Total Rows Processed: 5146882, Total Chunk Time: 0.030 seconds
## Rows Read: 20522, Total Rows Processed: 5167404, Total Chunk Time: 0.029 seconds
## Rows Read: 14676, Total Rows Processed: 5182080, Total Chunk Time: 0.026 seconds
## Rows Read: 20456, Total Rows Processed: 5202536, Total Chunk Time: 0.366 seconds
## Rows Read: 20565, Total Rows Processed: 5223101, Total Chunk Time: 0.030 seconds
## Rows Read: 20536, Total Rows Processed: 5243637, Total Chunk Time: 0.026 seconds
## Rows Read: 14675, Total Rows Processed: 5258312, Total Chunk Time: 0.024 seconds
## Rows Read: 20454, Total Rows Processed: 5278766, Total Chunk Time: 0.386 seconds
## Rows Read: 20536, Total Rows Processed: 5299302, Total Chunk Time: 0.032 seconds
## Rows Read: 20536, Total Rows Processed: 5319838, Total Chunk Time: 0.031 seconds
## Rows Read: 14690, Total Rows Processed: 5334528, Total Chunk Time: 0.024 seconds
## Rows Read: 20538, Total Rows Processed: 5355066, Total Chunk Time: 0.319 seconds
## Rows Read: 20455, Total Rows Processed: 5375521, Total Chunk Time: 0.029 seconds
## Rows Read: 20553, Total Rows Processed: 5396074, Total Chunk Time: 0.028 seconds
## Rows Read: 14626, Total Rows Processed: 5410700, Total Chunk Time: 0.023 seconds
## Rows Read: 20513, Total Rows Processed: 5431213, Total Chunk Time: 0.713 seconds
## Rows Read: 20447, Total Rows Processed: 5451660, Total Chunk Time: 0.032 seconds
## Rows Read: 20480, Total Rows Processed: 5472140, Total Chunk Time: 0.030 seconds
## Rows Read: 14663, Total Rows Processed: 5486803, Total Chunk Time: 0.025 seconds
## Rows Read: 20481, Total Rows Processed: 5507284, Total Chunk Time: 0.317 seconds
## Rows Read: 20471, Total Rows Processed: 5527755, Total Chunk Time: 0.028 seconds
## Rows Read: 20462, Total Rows Processed: 5548217, Total Chunk Time: 0.028 seconds
## Rows Read: 14735, Total Rows Processed: 5562952, Total Chunk Time: 0.024 seconds
## Rows Read: 20398, Total Rows Processed: 5583350, Total Chunk Time: 0.477 seconds
## Rows Read: 20458, Total Rows Processed: 5603808, Total Chunk Time: 0.038 seconds
## Rows Read: 20644, Total Rows Processed: 5624452, Total Chunk Time: 0.029 seconds
## Rows Read: 14686, Total Rows Processed: 5639138, Total Chunk Time: 0.024 seconds
## Rows Read: 20541, Total Rows Processed: 5659679, Total Chunk Time: 0.327 seconds
## Rows Read: 20462, Total Rows Processed: 5680141, Total Chunk Time: 0.028 seconds
## Rows Read: 20508, Total Rows Processed: 5700649, Total Chunk Time: 0.028 seconds
## Rows Read: 14695, Total Rows Processed: 5715344, Total Chunk Time: 0.024 seconds
## Rows Read: 20432, Total Rows Processed: 5735776, Total Chunk Time: 0.332 seconds
## Rows Read: 20512, Total Rows Processed: 5756288, Total Chunk Time: 0.030 seconds
## Rows Read: 20556, Total Rows Processed: 5776844, Total Chunk Time: 0.029 seconds
## Rows Read: 14700, Total Rows Processed: 5791544, Total Chunk Time: 0.025 seconds
## Rows Read: 20536, Total Rows Processed: 5812080, Total Chunk Time: 0.328 seconds
## Rows Read: 20490, Total Rows Processed: 5832570, Total Chunk Time: 0.033 seconds
## Rows Read: 20605, Total Rows Processed: 5853175, Total Chunk Time: 0.031 seconds
## Rows Read: 14617, Total Rows Processed: 5867792, Total Chunk Time: 0.024 seconds
## Rows Read: 20494, Total Rows Processed: 5888286, Total Chunk Time: 0.418 seconds
## Rows Read: 20573, Total Rows Processed: 5908859, Total Chunk Time: 0.028 seconds
## Rows Read: 20502, Total Rows Processed: 5929361, Total Chunk Time: 0.027 seconds
## Rows Read: 14718, Total Rows Processed: 5944079, Total Chunk Time: 0.024 seconds
## Rows Read: 20501, Total Rows Processed: 5964580, Total Chunk Time: 1.003 seconds
## Rows Read: 20500, Total Rows Processed: 5985080, Total Chunk Time: 0.027 seconds
## Rows Read: 20610, Total Rows Processed: 6005690, Total Chunk Time: 0.027 seconds
## Rows Read: 14721, Total Rows Processed: 6020411, Total Chunk Time: 0.024 seconds
## Rows Read: 20527, Total Rows Processed: 6040938, Total Chunk Time: 0.769 seconds
## Rows Read: 20594, Total Rows Processed: 6061532, Total Chunk Time: 0.039 seconds
## Rows Read: 20555, Total Rows Processed: 6082087, Total Chunk Time: 0.027 seconds
## Rows Read: 14675, Total Rows Processed: 6096762, Total Chunk Time: 0.024 seconds</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate ROC and Area Under the Curve (AUC).</span>

logitRoc &lt;-<span class="st"> </span><span class="kw">rxRoc</span>(<span class="st">&quot;ArrDel15&quot;</span>, <span class="st">&quot;ArrDel15_Pred&quot;</span>, logitPredict)
logitAuc &lt;-<span class="st"> </span><span class="kw">rxAuc</span>(logitRoc)

<span class="kw">plot</span>(logitRoc)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/-test-score-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate ROC and Area Under the Curve (AUC)</span>

treeRoc &lt;-<span class="st"> </span><span class="kw">rxRoc</span>(<span class="st">&quot;ArrDel15&quot;</span>, <span class="st">&quot;ArrDel15_Pred&quot;</span>, treePredict)
treeAuc &lt;-<span class="st"> </span><span class="kw">rxAuc</span>(treeRoc)

<span class="kw">plot</span>(treeRoc)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/-test-score-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">save</span>(dTreeModel, <span class="dt">file =</span> <span class="st">&quot;dTreeModel.RData&quot;</span>)</code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-manipulation-with-sparkr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/07-modeling-mrs.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
